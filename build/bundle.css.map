{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "..\\..\\App.svelte",
    "..\\..\\Attachment.svelte",
    "..\\..\\Photo.svelte",
    "..\\..\\Post.svelte",
    "..\\..\\PostLink.svelte",
    "..\\..\\Video.svelte"
  ],
  "sourcesContent": [
    "<script>\r\n    import Feed from './components/Feed.svelte';\r\n    import Credits from './components/Credits.svelte';\r\n    import { login, logout, getIsLoggedIn } from './vk/auth';\r\n    import { getNews } from './vk/data/news';\r\n\r\n    let error;\r\n    let isLoggedIn;\r\n    let news;\r\n    let source = 'All';\r\n\r\n    (async () => {\r\n        try {\r\n            isLoggedIn = await getIsLoggedIn();\r\n            if (isLoggedIn) {\r\n                news = await getNews();\r\n            }\r\n        } catch (e) {\r\n            error = e;\r\n        }\r\n    })();\r\n\r\n    async function handleLogoutClick() {\r\n        if (!confirm('Are you sure?')) {\r\n            return;\r\n        }\r\n\r\n        await logout();\r\n        isLoggedIn = false;\r\n        news = undefined;\r\n        localStorage.clear();\r\n    }\r\n\r\n    async function handleLoginClick() {\r\n        try {\r\n            isLoggedIn = await login();\r\n            if (isLoggedIn) {\r\n                news = await getNews();\r\n            }\r\n        } catch (e) {\r\n            error = e;\r\n        }\r\n    }\r\n\r\n    let readNewsCount = 0;\r\n    function updateReadCount() {\r\n        readNewsCount = news.filter((n) => n.seen).length;\r\n    }\r\n\r\n    async function markAllAsReadAndRefresh() {\r\n        news.forEach((n) => {\r\n            n.markSeen();\r\n        });\r\n        refresh();\r\n    }\r\n\r\n    async function refresh() {\r\n        window.scrollTo(0, 0);\r\n        news = undefined;\r\n        news = await getNews();\r\n        updateReadCount();\r\n    }\r\n\r\n    const showPostSource = source === 'All';\r\n</script>\r\n\r\n<!-- prettier-ignore -->\r\n<nav>\r\n    {#if news}\r\n        <span class=\"read-counter\">\r\n            Feed: {source} -- Read: {readNewsCount}/{news.length}\r\n        </span>\r\n    {/if}\r\n    {#if isLoggedIn}\r\n        <button on:click={handleLogoutClick} id=\"logout\">Logout</button>\r\n    {/if}\r\n</nav>\r\n<!-- prettier-ignore -->\r\n<main>\r\n    {#if isLoggedIn === false}\r\n        <p class=\"centered\">\r\n            <button on:click={handleLoginClick}>Log in with VK</button>\r\n        </p>\r\n    {:else if news}\r\n        {#if news.length > 0}\r\n            <Feed posts={news} \r\n                onPostRead={updateReadCount} \r\n                {showPostSource}\r\n            ></Feed>\r\n        {:else}\r\n            <p class=\"centered\">There's nothing new in your feed! Well done!</p>\r\n        {/if}\r\n        <p class=\"centered\">\r\n            <button on:click={markAllAsReadAndRefresh} class=\"refresh-button\">\r\n                <img class=\"refresh-icon\" src=\"icons/refresh.svg\" alt=\"\">\r\n            </button>\r\n        </p>\r\n    {:else if error}\r\n        <p class=\"centered\" style=\"color: red;\">{error.message}</p>\r\n    {:else}\r\n        <p class=\"centered\">Loading...</p>\r\n    {/if}\r\n    <p class=\"credits centered\">\r\n        <Credits className=\"centered\" />\r\n    </p>\r\n</main>\r\n{#if news}\r\n<button class=\"filter\">\r\n    <img class=\"filter-icon\" src=\"icons/filter.svg\" alt=\"\" />\r\n</button>\r\n{/if}\r\n\r\n<style>\r\n    :global(body) {\r\n        padding-top: 42px;\r\n    }\r\n    nav {\r\n        display: flex;\r\n        flex-direction: row;\r\n        justify-content: flex-end;\r\n        align-items: center;\r\n\r\n        background-color: #68a5eb;\r\n        height: 42px;\r\n\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        right: 0;\r\n\r\n        z-index: 1;\r\n    }\r\n    .read-counter {\r\n        margin-left: 24px;\r\n        margin-right: auto;\r\n\r\n        white-space: nowrap;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        color: #fff;\r\n    }\r\n    main {\r\n        padding: 8px;\r\n        margin: auto;\r\n        max-width: 500px;\r\n        min-width: 300px;\r\n        height: 100%;\r\n        box-sizing: border-box;\r\n        display: flex;\r\n        flex-direction: column;\r\n    }\r\n    #logout {\r\n        margin: 0;\r\n        margin-right: 8px;\r\n        font-size: 12px;\r\n    }\r\n    .centered {\r\n        text-align: center;\r\n    }\r\n    .refresh-button {\r\n        width: 70%;\r\n        margin: 0.5em 0;\r\n        padding: 1em;\r\n    }\r\n    .refresh-icon {\r\n        width: 10%;\r\n    }\r\n    .filter {\r\n        position: fixed;\r\n        bottom: 25px;\r\n        right: 25px;\r\n\r\n        width: 64px;\r\n        height: 64px;\r\n        border-radius: 50%;\r\n        padding: 1em;\r\n        box-shadow: 0px 0px 5px 1px rgba(0, 0, 0, 0.3);\r\n    }\r\n    .filter-icon {\r\n        width: 100%;\r\n    }\r\n    .credits {\r\n        margin-top: auto;\r\n        margin-bottom: 8px;\r\n        font-size: 0.8em;\r\n    }\r\n</style>\r\n",
    "<script>\n    import PostLink from './PostLink.svelte';\n    import Photo from './Photo.svelte';\n    import Video from './Video.svelte';\n    export let att;\n</script>\n\n<!-- prettier-ignore -->\n<div>\n    {#if att.type === 'photo'}\n        <Photo photo={att.photo}></Photo>\n    {:else if att.type === 'video'}\n        <span>Video frame:</span>\n        <Photo photo={att.video}></Photo>\n    {:else if att.type === 'doc' && att.doc.ext === 'gif'}\n        <Video {att}></Video>\n    {:else if att.type === 'doc' && att.doc.ext === 'pdf'}\n        <p>Doc: {att.doc.title}</p>\n    {:else if att.type === 'link'}\n        <PostLink {att}></PostLink>\n    {:else if att.type === 'podcast'}\n        <p>Podcast: {att.podcast.title}</p>\n    {:else if att.type === 'podcast'}\n        <p>Unsupported attachment: {JSON.stringify(att)}</p>\n    {/if}\n</div>\n\n<style>\n    p,\n    span {\n        word-break: break-word;\n        max-width: 100%;\n        font-style: italic;\n    }\n</style>\n",
    "<script>\n    import { selectPhoto } from '../utils/selectPhoto';\n\n    export let photo;\n\n    const photoSrc = selectPhoto(photo, 600);\n</script>\n\n<style>\n    img {\n        width: 100%;\n    }\n</style>\n\n<!-- prettier-ignore -->\n<img loading=\"lazy\" src={photoSrc} alt=\"\" srcset=\"\" />\n",
    "<script>\r\n    import { onMount, onDestroy } from 'svelte';\r\n    import Attachment from './Attachment.svelte';\r\n\r\n    export let post;\r\n    export let observer;\r\n    export let showPostSource;\r\n\r\n    const { postUrl, date, repost, sourceName, text, attachments, uid } = post;\r\n\r\n    let container;\r\n    onMount(() => {\r\n        if (!observer) return;\r\n        observer.observe(container);\r\n    });\r\n    onDestroy(() => {\r\n        if (!observer) return;\r\n        observer.unobserve(container);\r\n    });\r\n</script>\r\n\r\n<!-- prettier-ignore -->\r\n<div \r\n    bind:this={container} \r\n    class=\"post\"\r\n    class:seen={post.seen} \r\n    data-post-uid={uid}\r\n>\r\n    <p class=\"date\">{date}</p>\r\n    {#if showPostSource}\r\n        <h4>{sourceName}</h4>\r\n    {/if}\r\n    {#if text}\r\n        <p class=\"text\">{text}</p>\r\n    {/if}\r\n    {#if attachments}\r\n        {#each attachments as att, i}\r\n           <Attachment {att}></Attachment>\r\n        {/each}\r\n    {/if}\r\n    {#if repost}\r\n        <div class=\"post\">\r\n            <p class=\"date\">{repost.date}</p>\r\n            <h4>{repost.sourceName}</h4>\r\n            {#if repost.text}\r\n                <p class=\"text\">{repost.text}</p>\r\n            {/if}\r\n            {#if repost.attachments}\r\n                {#each repost.attachments as att, i}\r\n                    <Attachment {att}></Attachment>\r\n                {/each}\r\n            {/if}\r\n        </div>\r\n    {/if}\r\n    <p><a href={postUrl} target=\"_blank\">{postUrl}</a></p>\r\n</div>\r\n\r\n<style>\r\n    .post {\r\n        padding: 1em;\r\n        margin-bottom: 0.5em;\r\n        position: relative;\r\n        box-shadow: 0 0 3px rgb(128, 128, 128);\r\n    }\r\n    .text {\r\n        white-space: pre-wrap;\r\n        word-break: break-word;\r\n    }\r\n    .date {\r\n        color: #505050;\r\n        position: absolute;\r\n        top: 0.5em;\r\n        right: 0.5em;\r\n        font-size: 0.75em;\r\n        margin: 0;\r\n    }\r\n    .seen {\r\n        opacity: 0.5;\r\n    }\r\n</style>\r\n",
    "<script>\n    export let att;\n\n    let photoSrc;\n    if (att.link.photo) {\n        const photoSizes = Object.keys(att.link.photo).filter((k) =>\n            k.includes('photo')\n        );\n\n        // fixme replace with screensize based size\n        const medianQuality = Math.floor(photoSizes.length / 2);\n        photoSrc = att.link.photo[photoSizes[medianQuality]];\n    }\n</script>\n\n<!-- prettier-ignore -->\n<a href=\"{att.link.url}\" target=\"_blank\">\n    <div class=\"link\">\n        {#if photoSrc}\n            <img loading=\"lazy\" src=\"{photoSrc}\" alt=\"\" />\n        {/if}\n        <p>{att.link.title}</p>\n    </div>\n</a>\n\n<style>\n    img {\n        width: 100%;\n    }\n    .link {\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n        border: 1px solid rgba(0, 0, 0, 0.363);\n    }\n    .link img {\n        flex-shrink: 0;\n        height: 80px;\n        width: auto;\n    }\n    .link p {\n        margin: 0;\n        padding: 8px;\n    }\n</style>\n",
    "<script>\n    export let att;\n\n    // fixme choose poster based on screen size\n    const posterSrc = att.doc.preview.photo.sizes[0].src;\n    const videoSrc =\n        (att.doc.preview.video && att.doc.preview.video.src) || att.doc.url;\n</script>\n\n<style>\n    video {\n        width: 100%;\n    }\n</style>\n\n<!-- prettier-ignore -->\n<video\n    src=\"{videoSrc}\"\n    poster=\"{posterSrc}\"\n    preload=\"none\"\n    controls\n    type=\"video/mp4\"\n/>\n"
  ],
  "names": [],
  "mappings": "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"
}