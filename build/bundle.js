var app=function(){"use strict";function t(){}const e=t=>t;function n(t,e){for(const n in e)t[n]=e[n];return t}function o(t){return t()}function s(){return Object.create(null)}function r(t){t.forEach(o)}function c(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}const u="undefined"!=typeof window;let a=u?()=>window.performance.now():()=>Date.now(),d=u?t=>requestAnimationFrame(t):t;const f=new Set;function p(t){f.forEach(e=>{e.c(t)||(f.delete(e),e.f())}),0!==f.size&&d(p)}function h(t,e){t.appendChild(e)}function m(t,e,n){t.insertBefore(e,n||null)}function g(t){t.parentNode.removeChild(t)}function $(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function w(t){return document.createElement(t)}function v(t){return document.createTextNode(t)}function y(){return v(" ")}function b(){return v("")}function _(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function x(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function k(t,e){const n=Object.getOwnPropertyDescriptors(t.__proto__);for(const o in e)null==e[o]?t.removeAttribute(o):"style"===o?t.style.cssText=e[o]:"__value"===o||n[o]&&n[o].set?t[o]=e[o]:x(t,o,e[o])}function S(t,e){e=""+e,t.data!==e&&(t.data=e)}function C(t,e,n){t.classList[n?"add":"remove"](e)}const E=new Set;let N,A=0;function L(t,e,n,o,s,r,c,l=0){const i=16.666/o;let u="{\n";for(let t=0;t<=1;t+=i){const o=e+(n-e)*r(t);u+=100*t+`%{${c(o,1-o)}}\n`}const a=u+`100% {${c(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(a)}_${l}`,f=t.ownerDocument;E.add(f);const p=f.__svelte_stylesheet||(f.__svelte_stylesheet=f.head.appendChild(w("style")).sheet),h=f.__svelte_rules||(f.__svelte_rules={});h[d]||(h[d]=!0,p.insertRule(`@keyframes ${d} ${a}`,p.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?m+", ":""}${d} ${o}ms linear ${s}ms 1 both`,A+=1,d}function O(t,e){const n=(t.style.animation||"").split(", "),o=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),s=n.length-o.length;s&&(t.style.animation=o.join(", "),A-=s,A||d(()=>{A||(E.forEach(t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}}),E.clear())}))}function j(t){N=t}function P(){if(!N)throw new Error("Function called outside component initialization");return N}const z=[],D=[],I=[],M=[],F=Promise.resolve();let T=!1;function K(t){I.push(t)}let R=!1;const V=new Set;function H(){if(!R){R=!0;do{for(let t=0;t<z.length;t+=1){const e=z[t];j(e),B(e.$$)}for(z.length=0;D.length;)D.pop()();for(let t=0;t<I.length;t+=1){const e=I[t];V.has(e)||(V.add(e),e())}I.length=0}while(z.length);for(;M.length;)M.pop()();T=!1,R=!1,V.clear()}}function B(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(K)}}let G;function U(t,e,n){t.dispatchEvent(function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(`${e?"intro":"outro"}${n}`))}const Y=new Set;let q;function J(){q={r:0,c:[],p:q}}function W(){q.r||r(q.c),q=q.p}function Q(t,e){t&&t.i&&(Y.delete(t),t.i(e))}function X(t,e,n,o){if(t&&t.o){if(Y.has(t))return;Y.add(t),q.c.push(()=>{Y.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}const Z={duration:0};function tt(n,o,s,l){let i=o(n,s),u=l?0:1,h=null,m=null,g=null;function $(){g&&O(n,g)}function w(t,e){const n=t.b-u;return e*=Math.abs(n),{a:u,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function v(o){const{delay:s=0,duration:c=300,easing:l=e,tick:v=t,css:y}=i||Z,b={start:a()+s,b:o};o||(b.group=q,q.r+=1),h?m=b:(y&&($(),g=L(n,u,o,c,s,l,y)),o&&v(0,1),h=w(b,c),K(()=>U(n,o,"start")),function(t){let e;0===f.size&&d(p),new Promise(n=>{f.add(e={c:t,f:n})})}(t=>{if(m&&t>m.start&&(h=w(m,c),m=null,U(n,h.b,"start"),y&&($(),g=L(n,u,h.b,h.duration,0,l,i.css))),h)if(t>=h.end)v(u=h.b,1-u),U(n,h.b,"end"),m||(h.b?$():--h.group.r||r(h.group.c)),h=null;else if(t>=h.start){const e=t-h.start;u=h.a+h.d*l(e/h.duration),v(u,1-u)}return!(!h&&!m)}))}return{run(t){c(i)?(G||(G=Promise.resolve(),G.then(()=>{G=null})),G).then(()=>{i=i(),v(t)}):v(t)},end(){$(),h=m=null}}}function et(t,e){X(t,1,1,()=>{e.delete(t.key)})}function nt(t){t&&t.c()}function ot(t,e,n){const{fragment:s,on_mount:l,on_destroy:i,after_update:u}=t.$$;s&&s.m(e,n),K(()=>{const e=l.map(o).filter(c);i?i.push(...e):r(e),t.$$.on_mount=[]}),u.forEach(K)}function st(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function rt(t,e){-1===t.$$.dirty[0]&&(z.push(t),T||(T=!0,F.then(H)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ct(e,n,o,c,l,i,u=[-1]){const a=N;j(e);const d=n.props||{},f=e.$$={fragment:null,ctx:null,props:i,update:t,not_equal:l,bound:s(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:s(),dirty:u};let p=!1;if(f.ctx=o?o(e,d,(t,n,...o)=>{const s=o.length?o[0]:n;return f.ctx&&l(f.ctx[t],f.ctx[t]=s)&&(f.bound[t]&&f.bound[t](s),p&&rt(e,t)),n}):[],f.update(),p=!0,r(f.before_update),f.fragment=!!c&&c(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(g)}else f.fragment&&f.fragment.c();n.intro&&Q(e.$$.fragment),ot(e,n.target,n.anchor),H()}j(a)}class lt{$destroy(){st(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function it(t){return function(t){var e;do{e=t,t=t.replace(at,"")}while(t!==e);return t.replace(/</g,"&lt;")}(t).replace(/(?:(https?\:\/\/[^\s]+))/gm,'<a href="$1" target="_blank">$1</a>')}var ut="(?:[^\"'>]|\"[^\"]*\"|'[^']*')*",at=new RegExp("<(?:!--(?:(?:-*[^->])*--+|-?)|script\\b"+ut+">[\\s\\S]*?</script\\s*|style\\b"+ut+">[\\s\\S]*?</style\\s*|/?[a-z]"+ut+")>","gi");function dt(t){let e,n;return{c(){e=w("img"),e.src!==(n=t[1])&&x(e,"src",n),x(e,"alt",""),x(e,"class","svelte-okjk95")},m(t,n){m(t,e,n)},p(t,o){2&o&&e.src!==(n=t[1])&&x(e,"src",n)},d(t){t&&g(e)}}}function ft(e){let n,o,s,r,c,l,i=e[0].link.title+"",u=e[1]&&dt(e);return{c(){n=w("a"),o=w("div"),u&&u.c(),s=y(),r=w("p"),c=v(i),x(r,"class","svelte-okjk95"),x(o,"class","link svelte-okjk95"),x(n,"href",l=e[0].link.url),x(n,"target","_blank")},m(t,e){m(t,n,e),h(n,o),u&&u.m(o,null),h(o,s),h(o,r),h(r,c)},p(t,[e]){t[1]?u?u.p(t,e):(u=dt(t),u.c(),u.m(o,s)):u&&(u.d(1),u=null),1&e&&i!==(i=t[0].link.title+"")&&S(c,i),1&e&&l!==(l=t[0].link.url)&&x(n,"href",l)},i:t,o:t,d(t){t&&g(n),u&&u.d()}}}function pt(t,e,n){let o,{att:s}=e;if(s.link.photo){const t=Object.keys(s.link.photo).filter(t=>t.includes("photo")),e=Math.floor(t.length/2);o=s.link.photo[t[e]]}return t.$set=t=>{"att"in t&&n(0,s=t.att)},[s,o]}class ht extends lt{constructor(t){super(),ct(this,t,pt,ft,l,{att:0})}}function mt(e){let o,s=[{loading:"lazy"},{alt:""},e[0]],r={};for(let t=0;t<s.length;t+=1)r=n(r,s[t]);return{c(){o=w("img"),k(o,r)},m(t,e){m(t,o,e)},p(t,[e]){k(o,function(t,e){const n={},o={},s={$$scope:1};let r=t.length;for(;r--;){const c=t[r],l=e[r];if(l){for(const t in c)t in l||(o[t]=1);for(const t in l)s[t]||(n[t]=l[t],s[t]=1);t[r]=l}else for(const t in c)s[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}(s,[{loading:"lazy"},{alt:""},1&e&&t[0]]))},i:t,o:t,d(t){t&&g(o)}}}function gt(t,e,n){let{photo:o}=e,{width:s}=e;const r=function(t,e){const n=Object.keys(t).filter(t=>t.includes("photo"));let o,s;for(let s=0;s<n.length;s++){if(n[s].split("_")[1]>=e||s===n.length-1){o=t[n[s]];break}}return s=t.height?function({width:t,height:e},n){return{width:n,height:n/(t/e)}}(t,e):{width:e},{src:o,...s}}(o,s);return t.$set=t=>{"photo"in t&&n(1,o=t.photo),"width"in t&&n(2,s=t.width)},[r,o,s]}class $t extends lt{constructor(t){super(),ct(this,t,gt,mt,l,{photo:1,width:2})}}function wt(e){let n,o;return{c(){n=w("video"),n.src!==(o=e[1])&&x(n,"src",o),x(n,"poster",e[0]),x(n,"preload","none"),n.controls=!0,x(n,"type","video/mp4"),x(n,"class","svelte-11r8rfd")},m(t,e){m(t,n,e)},p:t,i:t,o:t,d(t){t&&g(n)}}}function vt(t,e,n){let{att:o}=e;const s=o.doc.preview.photo.sizes[0].src,r=o.doc.preview.video&&o.doc.preview.video.src||o.doc.url;return t.$set=t=>{"att"in t&&n(2,o=t.att)},[s,r,o]}class yt extends lt{constructor(t){super(),ct(this,t,vt,wt,l,{att:2})}}function bt(e){let n,o,s,r=JSON.stringify(e[0])+"";return{c(){n=w("p"),o=v("Unsupported attachment: "),s=v(r),x(n,"class","svelte-3z90vw")},m(t,e){m(t,n,e),h(n,o),h(n,s)},p(t,e){1&e&&r!==(r=JSON.stringify(t[0])+"")&&S(s,r)},i:t,o:t,d(t){t&&g(n)}}}function _t(e){let n,o,s,r=e[0].podcast.title+"";return{c(){n=w("p"),o=v("Podcast: "),s=v(r),x(n,"class","svelte-3z90vw")},m(t,e){m(t,n,e),h(n,o),h(n,s)},p(t,e){1&e&&r!==(r=t[0].podcast.title+"")&&S(s,r)},i:t,o:t,d(t){t&&g(n)}}}function xt(t){let e;const n=new ht({props:{att:t[0]}});return{c(){nt(n.$$.fragment)},m(t,o){ot(n,t,o),e=!0},p(t,e){const o={};1&e&&(o.att=t[0]),n.$set(o)},i(t){e||(Q(n.$$.fragment,t),e=!0)},o(t){X(n.$$.fragment,t),e=!1},d(t){st(n,t)}}}function kt(e){let n,o,s,r=e[0].doc.title+"";return{c(){n=w("p"),o=v("Doc: "),s=v(r),x(n,"class","svelte-3z90vw")},m(t,e){m(t,n,e),h(n,o),h(n,s)},p(t,e){1&e&&r!==(r=t[0].doc.title+"")&&S(s,r)},i:t,o:t,d(t){t&&g(n)}}}function St(t){let e;const n=new yt({props:{att:t[0]}});return{c(){nt(n.$$.fragment)},m(t,o){ot(n,t,o),e=!0},p(t,e){const o={};1&e&&(o.att=t[0]),n.$set(o)},i(t){e||(Q(n.$$.fragment,t),e=!0)},o(t){X(n.$$.fragment,t),e=!1},d(t){st(n,t)}}}function Ct(t){let e,n,o;const s=new $t({props:{width:t[1],photo:t[0].video}});return{c(){e=w("span"),e.textContent="Video frame:",n=y(),nt(s.$$.fragment),x(e,"class","svelte-3z90vw")},m(t,r){m(t,e,r),m(t,n,r),ot(s,t,r),o=!0},p(t,e){const n={};2&e&&(n.width=t[1]),1&e&&(n.photo=t[0].video),s.$set(n)},i(t){o||(Q(s.$$.fragment,t),o=!0)},o(t){X(s.$$.fragment,t),o=!1},d(t){t&&g(e),t&&g(n),st(s,t)}}}function Et(t){let e;const n=new $t({props:{width:t[1],photo:t[0].photo}});return{c(){nt(n.$$.fragment)},m(t,o){ot(n,t,o),e=!0},p(t,e){const o={};2&e&&(o.width=t[1]),1&e&&(o.photo=t[0].photo),n.$set(o)},i(t){e||(Q(n.$$.fragment,t),e=!0)},o(t){X(n.$$.fragment,t),e=!1},d(t){st(n,t)}}}function Nt(t){let e,n,o,s;const r=[Et,Ct,St,kt,xt,_t,bt],c=[];function l(t,e){return"photo"===t[0].type?0:"video"===t[0].type?1:"doc"===t[0].type&&"gif"===t[0].doc.ext?2:"doc"===t[0].type&&"pdf"===t[0].doc.ext?3:"link"===t[0].type?4:"podcast"===t[0].type?5:"podcast"===t[0].type?6:-1}return~(n=l(t))&&(o=c[n]=r[n](t)),{c(){e=w("div"),o&&o.c()},m(t,o){m(t,e,o),~n&&c[n].m(e,null),s=!0},p(t,[s]){let i=n;n=l(t),n===i?~n&&c[n].p(t,s):(o&&(J(),X(c[i],1,1,()=>{c[i]=null}),W()),~n?(o=c[n],o||(o=c[n]=r[n](t),o.c()),Q(o,1),o.m(e,null)):o=null)},i(t){s||(Q(o),s=!0)},o(t){X(o),s=!1},d(t){t&&g(e),~n&&c[n].d()}}}function At(t,e,n){let{att:o}=e,{width:s}=e;return t.$set=t=>{"att"in t&&n(0,o=t.att),"width"in t&&n(1,s=t.width)},[o,s]}class Lt extends lt{constructor(t){super(),ct(this,t,At,Nt,l,{att:0,width:1})}}function Ot(t,e,n){const o=t.slice();return o[14]=e[n],o[16]=n,o}function jt(t,e,n){const o=t.slice();return o[14]=e[n],o[16]=n,o}function Pt(t){let e,n;return{c(){e=w("img"),x(e,"class","seen-icon svelte-1jpy740"),e.src!==(n="./icons/eye.svg")&&x(e,"src","./icons/eye.svg"),x(e,"alt","")},m(t,n){m(t,e,n)},d(t){t&&g(e)}}}function zt(e){let n;return{c(){n=w("h4"),n.textContent=""+e[7]},m(t,e){m(t,n,e)},p:t,d(t){t&&g(n)}}}function Dt(t){let e;const n=new Lt({props:{att:t[14],width:t[2]-32}});return{c(){nt(n.$$.fragment)},m(t,o){ot(n,t,o),e=!0},p(t,e){const o={};4&e&&(o.width=t[2]-32),n.$set(o)},i(t){e||(Q(n.$$.fragment,t),e=!0)},o(t){X(n.$$.fragment,t),e=!1},d(t){st(n,t)}}}function It(e){let n,o,s,r,c,l,i,u,a=e[6].text&&function(e){let n;return{c(){n=w("p"),n.textContent=""+e[6].text,x(n,"class","text svelte-1jpy740")},m(t,e){m(t,n,e)},p:t,d(t){t&&g(n)}}}(e),d=e[6].attachments&&function(t){let e,n,o=t[6].attachments,s=[];for(let e=0;e<o.length;e+=1)s[e]=Mt(Ot(t,o,e));const r=t=>X(s[t],1,1,()=>{s[t]=null});return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=b()},m(t,o){for(let e=0;e<s.length;e+=1)s[e].m(t,o);m(t,e,o),n=!0},p(t,n){if(68&n){let c;for(o=t[6].attachments,c=0;c<o.length;c+=1){const r=Ot(t,o,c);s[c]?(s[c].p(r,n),Q(s[c],1)):(s[c]=Mt(r),s[c].c(),Q(s[c],1),s[c].m(e.parentNode,e))}for(J(),c=o.length;c<s.length;c+=1)r(c);W()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)Q(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)X(s[t]);n=!1},d(t){$(s,t),t&&g(e)}}}(e);return{c(){n=w("div"),o=w("div"),s=w("span"),s.textContent=""+e[6].date,r=y(),c=w("h4"),c.textContent=""+e[6].sourceName,l=y(),a&&a.c(),i=y(),d&&d.c(),x(s,"class","date svelte-1jpy740"),x(o,"class","corner svelte-1jpy740"),x(n,"class","post repost svelte-1jpy740")},m(t,e){m(t,n,e),h(n,o),h(o,s),h(n,r),h(n,c),h(n,l),a&&a.m(n,null),h(n,i),d&&d.m(n,null),u=!0},p(t,e){t[6].text&&a.p(t,e),t[6].attachments&&d.p(t,e)},i(t){u||(Q(d),u=!0)},o(t){X(d),u=!1},d(t){t&&g(n),a&&a.d(),d&&d.d()}}}function Mt(t){let e;const n=new Lt({props:{att:t[14],width:t[2]-64}});return{c(){nt(n.$$.fragment)},m(t,o){ot(n,t,o),e=!0},p(t,e){const o={};4&e&&(o.width=t[2]-64),n.$set(o)},i(t){e||(Q(n.$$.fragment,t),e=!0)},o(t){X(n.$$.fragment,t),e=!1},d(t){st(n,t)}}}function Ft(e){let n,o,s,r,c,l,i,u,a,d,f,p,_,k=e[0].seen&&Pt(),S=e[1]&&zt(e),E=e[8]&&function(e){let n,o=it(e[8])+"";return{c(){n=w("p"),x(n,"class","text svelte-1jpy740")},m(t,e){m(t,n,e),n.innerHTML=o},p:t,d(t){t&&g(n)}}}(e),N=e[9]&&function(t){let e,n,o=t[9],s=[];for(let e=0;e<o.length;e+=1)s[e]=Dt(jt(t,o,e));const r=t=>X(s[t],1,1,()=>{s[t]=null});return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=b()},m(t,o){for(let e=0;e<s.length;e+=1)s[e].m(t,o);m(t,e,o),n=!0},p(t,n){if(516&n){let c;for(o=t[9],c=0;c<o.length;c+=1){const r=jt(t,o,c);s[c]?(s[c].p(r,n),Q(s[c],1)):(s[c]=Dt(r),s[c].c(),Q(s[c],1),s[c].m(e.parentNode,e))}for(J(),c=o.length;c<s.length;c+=1)r(c);W()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)Q(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)X(s[t]);n=!1},d(t){$(s,t),t&&g(e)}}}(e),A=e[6]&&It(e);return{c(){n=w("div"),o=w("div"),k&&k.c(),s=y(),r=w("span"),r.textContent=""+e[5],c=y(),S&&S.c(),l=y(),E&&E.c(),i=y(),N&&N.c(),u=y(),A&&A.c(),a=y(),d=w("p"),f=w("a"),p=v(e[4]),x(r,"class","date svelte-1jpy740"),x(o,"class","corner svelte-1jpy740"),x(f,"href",e[4]),x(f,"target","_blank"),x(n,"class","post svelte-1jpy740"),x(n,"data-post-uid",e[10]),C(n,"seen",e[0].seen)},m(t,g){m(t,n,g),h(n,o),k&&k.m(o,null),h(o,s),h(o,r),h(n,c),S&&S.m(n,null),h(n,l),E&&E.m(n,null),h(n,i),N&&N.m(n,null),h(n,u),A&&A.m(n,null),h(n,a),h(n,d),h(d,f),h(f,p),e[13](n),_=!0},p(t,[e]){t[0].seen?k||(k=Pt(),k.c(),k.m(o,s)):k&&(k.d(1),k=null),t[1]?S?S.p(t,e):(S=zt(t),S.c(),S.m(n,l)):S&&(S.d(1),S=null),t[8]&&E.p(t,e),t[9]&&N.p(t,e),t[6]&&A.p(t,e),1&e&&C(n,"seen",t[0].seen)},i(t){_||(Q(N),Q(A),_=!0)},o(t){X(N),X(A),_=!1},d(t){t&&g(n),k&&k.d(),S&&S.d(),E&&E.d(),N&&N.d(),A&&A.d(),e[13](null)}}}function Tt(t,e,n){let{post:o}=e,{observer:s}=e,{showPostSource:r}=e,{width:c}=e;const{postUrl:l,date:i,repost:u,sourceName:a,text:d,attachments:f,uid:p,seen:h}=o;let m;var g;return g=()=>{s&&s.observe(m)},P().$$.on_mount.push(g),function(t){P().$$.on_destroy.push(t)}(()=>{s&&s.unobserve(m)}),t.$set=t=>{"post"in t&&n(0,o=t.post),"observer"in t&&n(11,s=t.observer),"showPostSource"in t&&n(1,r=t.showPostSource),"width"in t&&n(2,c=t.width)},[o,r,c,m,l,i,u,a,d,f,p,s,h,function(t){D[t?"unshift":"push"](()=>{n(3,m=t)})}]}class Kt extends lt{constructor(t){super(),ct(this,t,Tt,Ft,l,{post:0,observer:11,showPostSource:1,width:2})}}const Rt=[];function Vt(e,n=t){let o;const s=[];function r(t){if(l(e,t)&&(e=t,o)){const t=!Rt.length;for(let t=0;t<s.length;t+=1){const n=s[t];n[1](),Rt.push(n,e)}if(t){for(let t=0;t<Rt.length;t+=2)Rt[t][0](Rt[t+1]);Rt.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(c,l=t){const i=[c,l];return s.push(i),1===s.length&&(o=n(r)||t),c(e),()=>{const t=s.indexOf(i);-1!==t&&s.splice(t,1),0===s.length&&(o(),o=null)}}}}function Ht(t){return new Date(1e3*t)}function Bt(t){return`${t.getFullYear()}-${t.getMonth()}-${t.getDate()}`}class Gt{static hasPostBeenSeen(t){return function(t,e){const n=localStorage.getItem("seenPosts_"+Bt(e));return!!n&&n.includes(t+";")}(`${t.source_id}_${t.post_id}`,Ht(t.date))}constructor(t,e){this.sourceName=e[-t.source_id],this.uid=`${t.source_id}_${t.post_id}`,this.postUrl="https://vk.com/wall"+this.uid,this._date=Ht(t.date),this.date=this._date.toLocaleString("ru"),this.text=t.text,this.seen=Gt.hasPostBeenSeen(t);const[n]=t.copy_history||[];n&&(this.repost={sourceName:e[-n.from_id],date:Ht(n.date).toLocaleString("ru"),attachments:n.attachments,text:n.text}),this.attachments=t.attachments}markSeen(){this.seen||(!function(t,e){const n="seenPosts_"+Bt(e),o=localStorage.getItem(n)||"";localStorage.setItem(n,`${o}${t};`)}(this.uid,this._date),this.seen=!0)}}const Ut="EMPTY",Yt="LOADING",qt="LOADED",Jt="FAILED",Wt=function(){const t={status:Ut,feedName:"All",feeds:{All:[]},feed:[]},e=[],{subscribe:n,set:o,update:s}=Vt(t);return{subscribe:n,load:async()=>{s(t=>({...t,status:Yt}));try{const t=await new Promise((t,e)=>{VK.Api.call("newsfeed.get",{v:"5.73",return_banned:0,count:100,filters:"post",source_ids:"groups,pages"},(function(n){const{response:o}=n;if(!o)return void e(n);const s=function(t){const e={};return t.forEach(t=>{e[t.id]=t.name}),e}(o.groups),r=o.items.filter(t=>!Gt.hasPostBeenSeen(t)).map(t=>new Gt(t,s));var c,l;t({All:r,...(c=r,l="sourceName",c.reduce((function(t,e){return(t[e[l]]=t[e[l]]||[]).push(e),t}),{}))})}))}),e=localStorage.getItem("lastFeed");let n;t[e]?n=e:(n="All",Qt("All"));const s=t[n];o({status:qt,feeds:t,feedName:n,feed:s})}catch(t){console.error(t),o({status:Jt})}},reset:()=>{o(t)},setFeed:t=>{s(e=>({...e,feedName:t,feed:e.feeds[t].filter(t=>!t.seen)})),e.forEach(t=>{t()}),Qt(t)},onFeedChanged:t=>{e.push(t)},markSeen:t=>{s(e=>(e.feed.find(e=>e.uid===t).markSeen(),e))},markFeedSeen:()=>{s(t=>(t.feed.forEach(t=>t.markSeen()),t))}}}();function Qt(t){localStorage.setItem("lastFeed",t)}function Xt(t,e,n){const o=t.slice();return o[6]=e[n],o[8]=n,o}function Zt(e){let n;return{c(){n=w("p"),n.textContent="Loading posts...",x(n,"class","svelte-1ux121r")},m(t,e){m(t,n,e)},p:t,i:t,o:t,d(t){t&&g(n)}}}function te(t){let e,n,o=[],s=new Map,r=t[2].feed;const c=t=>t[6].uid;for(let e=0;e<r.length;e+=1){let n=Xt(t,r,e),l=c(n);s.set(l,o[e]=ne(l,n))}let l=null;return r.length||(l=ee()),{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=b(),l&&l.c()},m(t,s){for(let e=0;e<o.length;e+=1)o[e].m(t,s);m(t,e,s),l&&l.m(t,s),n=!0},p(t,n){if(15&n){const r=t[2].feed;J(),o=function(t,e,n,o,s,r,c,l,i,u,a,d){let f=t.length,p=r.length,h=f;const m={};for(;h--;)m[t[h].key]=h;const g=[],$=new Map,w=new Map;for(h=p;h--;){const t=d(s,r,h),l=n(t);let i=c.get(l);i?o&&i.p(t,e):(i=u(l,t),i.c()),$.set(l,g[h]=i),l in m&&w.set(l,Math.abs(h-m[l]))}const v=new Set,y=new Set;function b(t){Q(t,1),t.m(l,a,c.has(t.key)),c.set(t.key,t),a=t.first,p--}for(;f&&p;){const e=g[p-1],n=t[f-1],o=e.key,s=n.key;e===n?(a=e.first,f--,p--):$.has(s)?!c.has(o)||v.has(o)?b(e):y.has(s)?f--:w.get(o)>w.get(s)?(y.add(o),b(e)):(v.add(s),f--):(i(n,c),f--)}for(;f--;){const e=t[f];$.has(e.key)||i(e,c)}for(;p;)b(g[p-1]);return g}(o,n,c,1,t,r,s,e.parentNode,et,ne,e,Xt),W(),r.length?l&&(l.d(1),l=null):l||(l=ee(),l.c(),l.m(e.parentNode,e))}},i(t){if(!n){for(let t=0;t<r.length;t+=1)Q(o[t]);n=!0}},o(t){for(let t=0;t<o.length;t+=1)X(o[t]);n=!1},d(t){for(let e=0;e<o.length;e+=1)o[e].d(t);t&&g(e),l&&l.d(t)}}}function ee(t){let e;return{c(){e=w("p"),e.textContent="There's nothing new in your feed! Well done!",x(e,"class","svelte-1ux121r")},m(t,n){m(t,e,n)},d(t){t&&g(e)}}}function ne(t,e){let n,o;const s=new Kt({props:{post:e[6],observer:e[3],showPostSource:e[1],width:e[0]}});return{key:t,first:null,c(){n=b(),nt(s.$$.fragment),this.first=n},m(t,e){m(t,n,e),ot(s,t,e),o=!0},p(t,e){const n={};4&e&&(n.post=t[6]),2&e&&(n.showPostSource=t[1]),1&e&&(n.width=t[0]),s.$set(n)},i(t){o||(Q(s.$$.fragment,t),o=!0)},o(t){X(s.$$.fragment,t),o=!1},d(t){t&&g(n),st(s,t)}}}function oe(t){let e,n,o,s,r;const c=[te,Zt],l=[];function i(t,e){return t[2].status===qt?0:1}return n=i(t),o=l[n]=c[n](t),{c(){e=w("div"),o.c(),x(e,"class","feed svelte-1ux121r"),K(()=>t[5].call(e))},m(o,c){m(o,e,c),l[n].m(e,null),s=function(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=document.createElement("object");let o;return n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.type="text/html",n.tabIndex=-1,n.onload=()=>{o=n.contentDocument.defaultView,o.addEventListener("resize",e)},/Trident/.test(navigator.userAgent)?(t.appendChild(n),n.data="about:blank"):(n.data="about:blank",t.appendChild(n)),{cancel:()=>{o&&o.removeEventListener&&o.removeEventListener("resize",e),t.removeChild(n)}}}(e,t[5].bind(e)),r=!0},p(t,[s]){let r=n;n=i(t),n===r?l[n].p(t,s):(J(),X(l[r],1,1,()=>{l[r]=null}),W(),o=l[n],o||(o=l[n]=c[n](t),o.c()),Q(o,1),o.m(e,null))},i(t){r||(Q(o),r=!0)},o(t){X(o),r=!1},d(t){t&&g(e),l[n].d(),s.cancel()}}}function se(t,e,n){let o,s;i(t,Wt,t=>n(2,o=t));const r=(t,e)=>{t.forEach(t=>{const{boundingClientRect:n,isIntersecting:o,target:s}=t;if(!o&&n.bottom<=0){const{postUid:t}=s.dataset;Wt.markSeen(t),e.unobserve(s)}})},c=new IntersectionObserver(r,{threshold:0});let l;return t.$$.update=()=>{4&t.$$.dirty&&n(1,l="All"===o.feedName)},[s,l,o,c,r,function(){s=this.clientWidth,n(0,s)}]}class re extends lt{constructor(t){super(),ct(this,t,se,oe,l,{})}}function ce(e){let n;return{c(){n=w("p"),n.innerHTML='\n    Icons made by\n    <a href="https://www.flaticon.com/authors/kiranshastry" title="Kiranshastry">\n        Kiranshastry\n    </a>\n    from\n    <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a>',x(n,"class","credits svelte-1g4sqtd")},m(t,e){m(t,n,e)},p:t,i:t,o:t,d(t){t&&g(n)}}}class le extends lt{constructor(t){super(),ct(this,t,null,ce,l,{})}}function ie(t){const e=t-1;return e*e*e+1}function ue(t){return--t*t*t*t*t+1}function ae(t,{delay:e=0,duration:n=400,easing:o=ie,x:s=0,y:r=0,opacity:c=0}){const l=getComputedStyle(t),i=+l.opacity,u="none"===l.transform?"":l.transform,a=i*(1-c);return{delay:e,duration:n,easing:o,css:(t,e)=>`\n\t\t\ttransform: ${u} translate(${(1-t)*s}px, ${(1-t)*r}px);\n\t\t\topacity: ${i-a*e}`}}const de=8194..toString();VK.init({apiId:7412293});const fe="LOADING",pe="LOGGED_IN",he="LOGGED_OUT",me=function(){const{subscribe:t,set:e}=Vt(fe);return(async()=>{try{const t=await new Promise((t,e)=>{setTimeout(()=>{t(!1)},3e3),VK.Auth.getLoginStatus(({status:e})=>{t("connected"===e)})});e(t?pe:he)}catch(t){console.error(t),e(he)}})(),{subscribe:t,login:async()=>{try{await new Promise((t,e)=>{VK.Auth.login(n=>{"connected"===n.status?t(n):e(n)},de)})&&e(pe)}catch(t){console.error(t),e(he)}},logout:async()=>{await new Promise((t,e)=>{VK.Auth.logout(()=>{t()})}),e(he),localStorage.clear()}}}();function ge(t){let e,n,o,s,r,c,l;return{c(){e=w("span"),n=v(t[0]),o=v(" ("),s=v(t[1]),r=v("/"),c=v(t[2]),l=v(")"),x(e,"class","title svelte-1asneev")},m(t,i){m(t,e,i),h(e,n),h(e,o),h(e,s),h(e,r),h(e,c),h(e,l)},p(t,e){1&e&&S(n,t[0]),2&e&&S(s,t[1]),4&e&&S(c,t[2])},d(t){t&&g(e)}}}function $e(e){let n,o;return{c(){n=w("button"),n.innerHTML='<img class="exit-icon svelte-1asneev" src="icons/door.svg" alt="">',x(n,"class","logout-btn svelte-1asneev")},m(t,e,s){m(t,n,e),s&&o(),o=_(n,"click",ve)},p:t,d(t){t&&g(n),o()}}}function we(t){let e,n,o,s,r=t[2]&&ge(t),c=t[3]===pe&&$e();return{c(){e=w("nav"),r&&r.c(),n=y(),c&&c.c(),x(e,"class","svelte-1asneev")},m(t,o){m(t,e,o),r&&r.m(e,null),h(e,n),c&&c.m(e,null),s=!0},p(t,[o]){t[2]?r?r.p(t,o):(r=ge(t),r.c(),r.m(e,n)):r&&(r.d(1),r=null),t[3]===pe?c?c.p(t,o):(c=$e(),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},i(n){s||(K(()=>{o||(o=tt(e,ae,t[4],!0)),o.run(1)}),s=!0)},o(n){o||(o=tt(e,ae,t[4],!1)),o.run(0),s=!1},d(t){t&&g(e),r&&r.d(),c&&c.d(),t&&o&&o.end()}}}function ve(){confirm("Are you sure?")&&me.logout()}function ye(t,e,n){let o,s;i(t,Wt,t=>n(5,o=t)),i(t,me,t=>n(3,s=t));let r,c,l;return t.$$.update=()=>{32&t.$$.dirty&&n(0,r=o.feedName),32&t.$$.dirty&&n(1,c=o.feed.filter(t=>t.seen).length),32&t.$$.dirty&&n(2,l=o.feed.length)},[r,c,l,s,{y:-100,opacity:.5}]}class be extends lt{constructor(t){super(),ct(this,t,ye,we,l,{})}}function _e(t,e,n){const o=t.slice();return o[10]=e[n],o}function xe(t){let e,n,o,s,c,l,i,u,a,d=t[6](t[2]),f=[];for(let e=0;e<d.length;e+=1)f[e]=Ce(_e(t,d,e));let p=null;return d.length||(p=Se()),{c(){e=w("div"),n=y(),o=w("div"),s=w("div");for(let t=0;t<f.length;t+=1)f[t].c();p&&p.c(),c=y(),l=w("button"),l.textContent="Close",x(e,"class","paranja svelte-nce24w"),x(s,"class","feeds svelte-nce24w"),x(l,"class","close svelte-nce24w"),x(o,"class","popup shadow svelte-nce24w")},m(i,d,g){m(i,e,d),m(i,n,d),m(i,o,d),h(o,s);for(let t=0;t<f.length;t+=1)f[t].m(s,null);p&&p.m(s,null),h(o,c),h(o,l),u=!0,g&&r(a),a=[_(e,"click",t[4]),_(l,"click",t[4])]},p(t,e){if(102&e){let n;for(d=t[6](t[2]),n=0;n<d.length;n+=1){const o=_e(t,d,n);f[n]?f[n].p(o,e):(f[n]=Ce(o),f[n].c(),f[n].m(s,null))}for(;n<f.length;n+=1)f[n].d(1);f.length=d.length,d.length?p&&(p.d(1),p=null):p||(p=Se(),p.c(),p.m(s,null))}},i(e){u||(K(()=>{i||(i=tt(o,ae,t[3],!0)),i.run(1)}),u=!0)},o(e){i||(i=tt(o,ae,t[3],!1)),i.run(0),u=!1},d(t){t&&g(e),t&&g(n),t&&g(o),$(f,t),p&&p.d(),t&&i&&i.end(),r(a)}}}function ke(e){let n,o,s,r;return{c(){n=w("button"),n.innerHTML='<img class="filter-icon svelte-nce24w" src="icons/filter.svg" alt="">',x(n,"class","filter-btn shadow svelte-nce24w")},m(t,o,c){m(t,n,o),s=!0,c&&r(),r=_(n,"click",e[4])},p:t,i(t){s||(K(()=>{o||(o=tt(n,ae,e[3],!0)),o.run(1)}),s=!0)},o(t){o||(o=tt(n,ae,e[3],!1)),o.run(0),s=!1},d(t){t&&g(n),t&&o&&o.end(),r()}}}function Se(t){let e;return{c(){e=v("There's no unseen posts!")},m(t,n){m(t,e,n)},d(t){t&&g(e)}}}function Ce(t){let e,n,o,s,c,l,i,u,a,d=t[10].name+"",f=t[10].unseen+"";return{c(){e=w("label"),n=w("input"),s=y(),c=v(d),l=v(" ("),i=v(f),u=v(")\n        "),x(n,"type","radio"),n.__value=o=t[10].name,n.value=n.__value,t[9][0].push(n),x(e,"class","feed svelte-nce24w")},m(o,d,f){m(o,e,d),h(e,n),n.checked=n.__value===t[1],h(e,s),h(e,c),h(e,l),h(e,i),h(e,u),f&&r(a),a=[_(n,"change",t[8]),_(n,"change",t[5])]},p(t,e){4&e&&o!==(o=t[10].name)&&(n.__value=o),n.value=n.__value,2&e&&(n.checked=n.__value===t[1]),4&e&&d!==(d=t[10].name+"")&&S(c,d),4&e&&f!==(f=t[10].unseen+"")&&S(i,f)},d(o){o&&g(e),t[9][0].splice(t[9][0].indexOf(n),1),r(a)}}}function Ee(t){let e,n,o,s;const r=[ke,xe],c=[];function l(t,e){return t[0]?0:1}return e=l(t),n=c[e]=r[e](t),{c(){n.c(),o=b()},m(t,n){c[e].m(t,n),m(t,o,n),s=!0},p(t,[s]){let i=e;e=l(t),e===i?c[e].p(t,s):(J(),X(c[i],1,1,()=>{c[i]=null}),W(),n=c[e],n||(n=c[e]=r[e](t),n.c()),Q(n,1),n.m(o.parentNode,o))},i(t){s||(Q(n),s=!0)},o(t){X(n),s=!1},d(t){c[e].d(t),t&&g(o)}}}function Ne(t,e,n){let o;i(t,Wt,t=>n(2,o=t));const s={y:1e3,opacity:.5,easing:ue};let r=!0;function c(){n(0,r=!r),document.body.style.overflow=r?"auto":"hidden"}let l=o.feedName;function u(t){return o.feeds[t].filter(t=>!t.seen).length}return[r,l,o,s,c,function(){Wt.setFeed(l),c()},function(t){return Object.keys(t.feeds).map(t=>({name:t,unseen:u(t)})).filter(t=>t.unseen>0)},u,function(){l=this.__value,n(1,l)},[[]]]}class Ae extends lt{constructor(t){super(),ct(this,t,Ne,Ee,l,{})}}const Le={subscribe:Vt(!0,t=>{let e=window.pageYOffset;window.onscroll=function(){const n=window.pageYOffset,o=n>e&&n>42,s=window.innerHeight+window.scrollY>=document.body.scrollHeight-.2*window.innerHeight;t(!(o&&!s)),e=n}}).subscribe};function Oe(t){let e;const n=new be({});return{c(){nt(n.$$.fragment)},m(t,o){ot(n,t,o),e=!0},i(t){e||(Q(n.$$.fragment,t),e=!0)},o(t){X(n.$$.fragment,t),e=!1},d(t){st(n,t)}}}function je(e){let n;return{c(){n=w("p"),n.textContent="Loading...",x(n,"class","svelte-z6wmp5")},m(t,e){m(t,n,e)},p:t,i:t,o:t,d(t){t&&g(n)}}}function Pe(e){let n;const o=new re({});return{c(){nt(o.$$.fragment)},m(t,e){ot(o,t,e),n=!0},p:t,i(t){n||(Q(o.$$.fragment,t),n=!0)},o(t){X(o.$$.fragment,t),n=!1},d(t){st(o,t)}}}function ze(e){let n,o,s;return{c(){n=w("p"),o=w("button"),o.textContent="Log in with VK",x(n,"class","svelte-z6wmp5")},m(t,e,r){m(t,n,e),h(n,o),r&&s(),s=_(o,"click",Ke)},p:t,i:t,o:t,d(t){t&&g(n),s()}}}function De(t){let e,n;function o(t,n){return(null==e||4&n)&&(e=!(t[2].feed.filter(Be).length!==t[2].feed.length)),e?Me:Ie}let s=o(t,-1),r=s(t);return{c(){r.c(),n=b()},m(t,e){r.m(t,e),m(t,n,e)},p(t,e){s===(s=o(t,e))&&r?r.p(t,e):(r.d(1),r=s(t),r&&(r.c(),r.m(n.parentNode,n)))},d(t){r.d(t),t&&g(n)}}}function Ie(e){let n,o;return{c(){n=w("button"),n.textContent="Mark all as read",x(n,"class","refresh-button svelte-z6wmp5")},m(t,e,s){m(t,n,e),s&&o(),o=_(n,"click",Re)},p:t,d(t){t&&g(n),o()}}}function Me(e){let n,o;return{c(){n=w("button"),n.textContent="Refresh",x(n,"class","refresh-button svelte-z6wmp5")},m(t,e,s){m(t,n,e),s&&o(),o=_(n,"click",He)},p:t,d(t){t&&g(n),o()}}}function Fe(t){let e;const n=new Ae({});return{c(){nt(n.$$.fragment)},m(t,o){ot(n,t,o),e=!0},i(t){e||(Q(n.$$.fragment,t),e=!0)},o(t){X(n.$$.fragment,t),e=!1},d(t){st(n,t)}}}function Te(t){let e,n,o,s,r,c,l,i,u,a=t[0]&&Oe();const d=[ze,Pe,je],f=[];function p(t,e){return t[1]===he?0:t[1]===pe?1:2}s=p(t),r=f[s]=d[s](t);let $=t[1]===pe&&t[2].status===qt&&De(t);const v=new le({});let b=t[2].status===qt&&t[0]&&Fe();return{c(){a&&a.c(),e=y(),n=w("main"),o=w("div"),r.c(),c=y(),$&&$.c(),l=y(),nt(v.$$.fragment),i=y(),b&&b.c(),x(o,"class","top svelte-z6wmp5"),x(n,"class","svelte-z6wmp5")},m(t,r){a&&a.m(t,r),m(t,e,r),m(t,n,r),h(n,o),f[s].m(o,null),h(n,c),$&&$.m(n,null),h(n,l),ot(v,n,null),h(n,i),b&&b.m(n,null),u=!0},p(t,[c]){t[0]?a?Q(a,1):(a=Oe(),a.c(),Q(a,1),a.m(e.parentNode,e)):a&&(J(),X(a,1,1,()=>{a=null}),W());let i=s;s=p(t),s===i?f[s].p(t,c):(J(),X(f[i],1,1,()=>{f[i]=null}),W(),r=f[s],r||(r=f[s]=d[s](t),r.c()),Q(r,1),r.m(o,null)),t[1]===pe&&t[2].status===qt?$?$.p(t,c):($=De(t),$.c(),$.m(n,l)):$&&($.d(1),$=null),t[2].status===qt&&t[0]?b?Q(b,1):(b=Fe(),b.c(),Q(b,1),b.m(n,null)):b&&(J(),X(b,1,1,()=>{b=null}),W())},i(t){u||(Q(a),Q(r),Q(v.$$.fragment,t),Q(b),u=!0)},o(t){X(a),X(r),X(v.$$.fragment,t),X(b),u=!1},d(t){a&&a.d(t),t&&g(e),t&&g(n),f[s].d(),$&&$.d(),st(v),b&&b.d()}}}function Ke(){me.login()}function Re(){Wt.markFeedSeen()}function Ve(){window.scrollTo(0,0)}function He(){Wt.load()}const Be=t=>t.seen;function Ge(t,e,n){let o,s,r;return i(t,Le,t=>n(0,o=t)),i(t,me,t=>n(1,s=t)),i(t,Wt,t=>n(2,r=t)),me.subscribe(t=>{t===pe&&Wt.load(),t===he&&Wt.reset()}),Wt.subscribe(t=>{window.n=t}),Wt.onFeedChanged(Ve),[o,s,r]}return history.scrollRestoration="manual",new class extends lt{constructor(t){super(),ct(this,t,Ge,Te,l,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
